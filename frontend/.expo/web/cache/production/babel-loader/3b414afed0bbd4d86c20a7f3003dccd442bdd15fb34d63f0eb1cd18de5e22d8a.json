{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{GoogleAuthProvider,signInWithPopup,signInWithRedirect,getRedirectResult}from'firebase/auth';import{initializeApp}from'firebase/app';import{getAuth}from'firebase/auth';import{getFirestore,enableIndexedDbPersistence}from'firebase/firestore';import env from\"../config/environment\";var firebaseConfig=env.firebase;console.log('Initializing Firebase with config:',_objectSpread(_objectSpread({},firebaseConfig),{},{apiKey:firebaseConfig.apiKey.substring(0,8)+'...'}));var app=initializeApp(firebaseConfig);var auth=getAuth(app);var db=getFirestore(app);try{enableIndexedDbPersistence(db).catch(function(err){if(err.code==='failed-precondition'){console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');}else if(err.code==='unimplemented'){console.warn('The current browser does not support persistence.');}});}catch(error){console.error('Error enabling persistence:',error);}console.log('Firebase initialized:',{auth:!!auth,db:!!db});export var signInWithGoogle=function(){var _ref=_asyncToGenerator(function*(){try{var provider=new GoogleAuthProvider();provider.setCustomParameters({prompt:'select_account',redirect_uri:window.location.origin,auth_type:'popup'});auth.useDeviceLanguage();var result=yield signInWithPopup(auth,provider);console.log('Google sign in successful:',result);return{name:result.user.displayName,email:result.user.email,uid:result.user.uid};}catch(error){console.error('Google sign in error:',error);throw new Error(`Sign in failed: ${error.message}`);}});return function signInWithGoogle(){return _ref.apply(this,arguments);};}();export var handleRedirectResult=function(){var _ref2=_asyncToGenerator(function*(){try{var result=yield getRedirectResult(auth);if(result){return{name:result.user.displayName,email:result.user.email,uid:result.user.uid};}return null;}catch(error){console.error('Redirect result error:',error);return null;}});return function handleRedirectResult(){return _ref2.apply(this,arguments);};}();","map":{"version":3,"names":["GoogleAuthProvider","signInWithPopup","signInWithRedirect","getRedirectResult","initializeApp","getAuth","getFirestore","enableIndexedDbPersistence","env","firebaseConfig","firebase","console","log","_objectSpread","apiKey","substring","app","auth","db","catch","err","code","warn","error","signInWithGoogle","_ref","_asyncToGenerator","provider","setCustomParameters","prompt","redirect_uri","window","location","origin","auth_type","useDeviceLanguage","result","name","user","displayName","email","uid","Error","message","apply","arguments","handleRedirectResult","_ref2"],"sources":["/Users/almorris/cursor-test/frontend/src/services/auth.js"],"sourcesContent":["import { GoogleAuthProvider, signInWithPopup, signInWithRedirect, getRedirectResult } from 'firebase/auth';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { getFirestore, enableIndexedDbPersistence } from 'firebase/firestore';\nimport env from '../config/environment';\n\nconst firebaseConfig = env.firebase;\n\nconsole.log('Initializing Firebase with config:', {\n  ...firebaseConfig,\n  apiKey: firebaseConfig.apiKey.substring(0, 8) + '...' // Log partial API key for security\n});\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\n// Enable offline persistence\ntry {\n  enableIndexedDbPersistence(db).catch((err) => {\n    if (err.code === 'failed-precondition') {\n      console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');\n    } else if (err.code === 'unimplemented') {\n      console.warn('The current browser does not support persistence.');\n    }\n  });\n} catch (error) {\n  console.error('Error enabling persistence:', error);\n}\n\n// Verify initialization\nconsole.log('Firebase initialized:', {\n  auth: !!auth,\n  db: !!db\n});\n\nexport const signInWithGoogle = async () => {\n  try {\n    const provider = new GoogleAuthProvider();\n    provider.setCustomParameters({\n      prompt: 'select_account',\n      redirect_uri: window.location.origin,\n      auth_type: 'popup'\n    });\n\n    // Configure auth instance\n    auth.useDeviceLanguage();\n\n    const result = await signInWithPopup(auth, provider);\n    console.log('Google sign in successful:', result);\n    return {\n      name: result.user.displayName,\n      email: result.user.email,\n      uid: result.user.uid\n    };\n  } catch (error) {\n    console.error('Google sign in error:', error);\n    throw new Error(`Sign in failed: ${error.message}`);\n  }\n};\n\n// Add handler for redirect result\nexport const handleRedirectResult = async () => {\n  try {\n    const result = await getRedirectResult(auth);\n    if (result) {\n      return {\n        name: result.user.displayName,\n        email: result.user.email,\n        uid: result.user.uid\n      };\n    }\n    return null;\n  } catch (error) {\n    console.error('Redirect result error:', error);\n    return null;\n  }\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}