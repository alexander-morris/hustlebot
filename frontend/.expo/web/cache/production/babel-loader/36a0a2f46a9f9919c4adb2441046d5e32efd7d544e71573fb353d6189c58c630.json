{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import{getFirestore,collection,addDoc,serverTimestamp}from'firebase/firestore';import{getApp}from'firebase/app';export var generateReferralCode=function(){var _ref=_asyncToGenerator(function*(userId){try{console.log('Generating referral code for user:',userId);var code=generateUniqueCode();console.log('Generated unique code:',code);try{var app=getApp();var db=getFirestore(app);var docData={code:code,createdBy:userId,createdAt:serverTimestamp(),expiresAt:new Date(Date.now()+48*60*60*1000),used:false,usedBy:null};addDoc(collection(db,'referralCodes'),docData).then(function(){return console.log('Successfully saved referral code to Firestore');}).catch(function(error){return console.error('Failed to save to Firestore:',error);});}catch(error){console.error('Firestore setup error:',error);}return code;}catch(error){console.error('Error generating referral code:',error);var tempCode=generateUniqueCode();console.log('Returning temporary code due to error:',tempCode);return tempCode;}});return function generateReferralCode(_x){return _ref.apply(this,arguments);};}();export function generateUniqueCode(){var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';var segments=3;var segmentLength=4;var code='';for(var i=0;i<segments;i++){for(var j=0;j<segmentLength;j++){code+=chars.charAt(Math.floor(Math.random()*chars.length));}if(i<segments-1)code+='-';}return code;}","map":{"version":3,"names":["getFirestore","collection","addDoc","serverTimestamp","getApp","generateReferralCode","_ref","_asyncToGenerator","userId","console","log","code","generateUniqueCode","app","db","docData","createdBy","createdAt","expiresAt","Date","now","used","usedBy","then","catch","error","tempCode","_x","apply","arguments","chars","segments","segmentLength","i","j","charAt","Math","floor","random","length"],"sources":["/Users/almorris/cursor-test/frontend/src/utils/referralUtils.js"],"sourcesContent":["import { getFirestore, collection, addDoc, serverTimestamp } from 'firebase/firestore';\nimport { getApp } from 'firebase/app';\n\nexport const generateReferralCode = async (userId) => {\n  try {\n    console.log('Generating referral code for user:', userId);\n    \n    // Generate a unique code\n    const code = generateUniqueCode();\n    console.log('Generated unique code:', code);\n    \n    // Try to save to Firestore but don't block on failure\n    try {\n      const app = getApp();\n      const db = getFirestore(app);\n      \n      const docData = {\n        code,\n        createdBy: userId,\n        createdAt: serverTimestamp(),\n        expiresAt: new Date(Date.now() + 48 * 60 * 60 * 1000),\n        used: false,\n        usedBy: null\n      };\n      \n      // Attempt to save but don't await\n      addDoc(collection(db, 'referralCodes'), docData)\n        .then(() => console.log('Successfully saved referral code to Firestore'))\n        .catch(error => console.error('Failed to save to Firestore:', error));\n    } catch (error) {\n      console.error('Firestore setup error:', error);\n    }\n    \n    return code;\n  } catch (error) {\n    console.error('Error generating referral code:', error);\n    const tempCode = generateUniqueCode();\n    console.log('Returning temporary code due to error:', tempCode);\n    return tempCode;\n  }\n};\n\nexport function generateUniqueCode() {\n  // Generate a code format: XXXX-XXXX-XXXX\n  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n  const segments = 3;\n  const segmentLength = 4;\n  \n  let code = '';\n  for (let i = 0; i < segments; i++) {\n    for (let j = 0; j < segmentLength; j++) {\n      code += chars.charAt(Math.floor(Math.random() * chars.length));\n    }\n    if (i < segments - 1) code += '-';\n  }\n  \n  return code;\n} "],"mappings":"uEAAA,OAASA,YAAY,CAAEC,UAAU,CAAEC,MAAM,CAAEC,eAAe,KAAQ,oBAAoB,CACtF,OAASC,MAAM,KAAQ,cAAc,CAErC,MAAO,IAAM,CAAAC,oBAAoB,gBAAAC,IAAA,CAAAC,iBAAA,CAAG,UAAOC,MAAM,CAAK,CACpD,GAAI,CACFC,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAEF,MAAM,CAAC,CAGzD,GAAM,CAAAG,IAAI,CAAGC,kBAAkB,CAAC,CAAC,CACjCH,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAEC,IAAI,CAAC,CAG3C,GAAI,CACF,GAAM,CAAAE,GAAG,CAAGT,MAAM,CAAC,CAAC,CACpB,GAAM,CAAAU,EAAE,CAAGd,YAAY,CAACa,GAAG,CAAC,CAE5B,GAAM,CAAAE,OAAO,CAAG,CACdJ,IAAI,CAAJA,IAAI,CACJK,SAAS,CAAER,MAAM,CACjBS,SAAS,CAAEd,eAAe,CAAC,CAAC,CAC5Be,SAAS,CAAE,GAAI,CAAAC,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,CAAG,EAAE,CAAG,EAAE,CAAG,EAAE,CAAG,IAAI,CAAC,CACrDC,IAAI,CAAE,KAAK,CACXC,MAAM,CAAE,IACV,CAAC,CAGDpB,MAAM,CAACD,UAAU,CAACa,EAAE,CAAE,eAAe,CAAC,CAAEC,OAAO,CAAC,CAC7CQ,IAAI,CAAC,iBAAM,CAAAd,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAC,GAAC,CACxEc,KAAK,CAAC,SAAAC,KAAK,QAAI,CAAAhB,OAAO,CAACgB,KAAK,CAAC,8BAA8B,CAAEA,KAAK,CAAC,GAAC,CACzE,CAAE,MAAOA,KAAK,CAAE,CACdhB,OAAO,CAACgB,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAChD,CAEA,MAAO,CAAAd,IAAI,CACb,CAAE,MAAOc,KAAK,CAAE,CACdhB,OAAO,CAACgB,KAAK,CAAC,iCAAiC,CAAEA,KAAK,CAAC,CACvD,GAAM,CAAAC,QAAQ,CAAGd,kBAAkB,CAAC,CAAC,CACrCH,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAEgB,QAAQ,CAAC,CAC/D,MAAO,CAAAA,QAAQ,CACjB,CACF,CAAC,iBArCY,CAAArB,oBAAoBA,CAAAsB,EAAA,SAAArB,IAAA,CAAAsB,KAAA,MAAAC,SAAA,OAqChC,CAED,MAAO,SAAS,CAAAjB,kBAAkBA,CAAA,CAAG,CAEnC,GAAM,CAAAkB,KAAK,CAAG,sCAAsC,CACpD,GAAM,CAAAC,QAAQ,CAAG,CAAC,CAClB,GAAM,CAAAC,aAAa,CAAG,CAAC,CAEvB,GAAI,CAAArB,IAAI,CAAG,EAAE,CACb,IAAK,GAAI,CAAAsB,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGF,QAAQ,CAAEE,CAAC,EAAE,CAAE,CACjC,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,CAAGF,aAAa,CAAEE,CAAC,EAAE,CAAE,CACtCvB,IAAI,EAAImB,KAAK,CAACK,MAAM,CAACC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,CAAGR,KAAK,CAACS,MAAM,CAAC,CAAC,CAChE,CACA,GAAIN,CAAC,CAAGF,QAAQ,CAAG,CAAC,CAAEpB,IAAI,EAAI,GAAG,CACnC,CAEA,MAAO,CAAAA,IAAI,CACb","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}