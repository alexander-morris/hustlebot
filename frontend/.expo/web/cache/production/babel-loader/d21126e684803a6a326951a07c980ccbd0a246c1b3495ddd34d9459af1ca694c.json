{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{GoogleAuthProvider,signInWithPopup,signInWithRedirect,getRedirectResult}from'firebase/auth';import{initializeApp}from'firebase/app';import{getAuth}from'firebase/auth';import{getFirestore,enableIndexedDbPersistence}from'firebase/firestore';import env from\"../config/environment\";var firebaseConfig=env.firebase;console.log('Initializing Firebase with config:',_objectSpread(_objectSpread({},firebaseConfig),{},{apiKey:firebaseConfig.apiKey.substring(0,8)+'...'}));var app=initializeApp(firebaseConfig);var auth=getAuth(app);var db=getFirestore(app);try{enableIndexedDbPersistence(db)[\"catch\"](function(err){if(err.code==='failed-precondition'){console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');}else if(err.code==='unimplemented'){console.warn('The current browser does not support persistence.');}});}catch(error){console.error('Error enabling persistence:',error);}console.log('Firebase initialized:',{auth:!!auth,db:!!db});export var signInWithGoogle=function(){var _ref=_asyncToGenerator(_regeneratorRuntime.mark(function _callee(){var provider,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;provider=new GoogleAuthProvider();provider.setCustomParameters({prompt:'select_account',redirect_uri:window.location.origin,auth_type:'popup'});auth.useDeviceLanguage();_context.next=6;return signInWithPopup(auth,provider);case 6:result=_context.sent;console.log('Google sign in successful:',result);return _context.abrupt(\"return\",{name:result.user.displayName,email:result.user.email,uid:result.user.uid});case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.error('Google sign in error:',_context.t0);throw new Error(\"Sign in failed: \".concat(_context.t0.message));case 15:case\"end\":return _context.stop();}},_callee,null,[[0,11]]);}));return function signInWithGoogle(){return _ref.apply(this,arguments);};}();export var handleRedirectResult=function(){var _ref2=_asyncToGenerator(_regeneratorRuntime.mark(function _callee2(){var result;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return getRedirectResult(auth);case 3:result=_context2.sent;if(!result){_context2.next=6;break;}return _context2.abrupt(\"return\",{name:result.user.displayName,email:result.user.email,uid:result.user.uid});case 6:return _context2.abrupt(\"return\",null);case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);console.error('Redirect result error:',_context2.t0);return _context2.abrupt(\"return\",null);case 13:case\"end\":return _context2.stop();}},_callee2,null,[[0,9]]);}));return function handleRedirectResult(){return _ref2.apply(this,arguments);};}();","map":{"version":3,"names":["GoogleAuthProvider","signInWithPopup","signInWithRedirect","getRedirectResult","initializeApp","getAuth","getFirestore","enableIndexedDbPersistence","env","firebaseConfig","firebase","console","log","_objectSpread","apiKey","substring","app","auth","db","err","code","warn","error","signInWithGoogle","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","provider","result","wrap","_callee$","_context","prev","next","setCustomParameters","prompt","redirect_uri","window","location","origin","auth_type","useDeviceLanguage","sent","abrupt","name","user","displayName","email","uid","t0","Error","concat","message","stop","apply","arguments","handleRedirectResult","_ref2","_callee2","_callee2$","_context2"],"sources":["/Users/almorris/cursor-test/frontend/src/services/auth.js"],"sourcesContent":["import { GoogleAuthProvider, signInWithPopup, signInWithRedirect, getRedirectResult } from 'firebase/auth';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth } from 'firebase/auth';\nimport { getFirestore, enableIndexedDbPersistence } from 'firebase/firestore';\nimport env from '../config/environment';\n\nconst firebaseConfig = env.firebase;\n\nconsole.log('Initializing Firebase with config:', {\n  ...firebaseConfig,\n  apiKey: firebaseConfig.apiKey.substring(0, 8) + '...' // Log partial API key for security\n});\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getFirestore(app);\n\n// Enable offline persistence\ntry {\n  enableIndexedDbPersistence(db).catch((err) => {\n    if (err.code === 'failed-precondition') {\n      console.warn('Multiple tabs open, persistence can only be enabled in one tab at a time.');\n    } else if (err.code === 'unimplemented') {\n      console.warn('The current browser does not support persistence.');\n    }\n  });\n} catch (error) {\n  console.error('Error enabling persistence:', error);\n}\n\n// Verify initialization\nconsole.log('Firebase initialized:', {\n  auth: !!auth,\n  db: !!db\n});\n\nexport const signInWithGoogle = async () => {\n  try {\n    const provider = new GoogleAuthProvider();\n    provider.setCustomParameters({\n      prompt: 'select_account',\n      redirect_uri: window.location.origin,\n      auth_type: 'popup'\n    });\n\n    // Configure auth instance\n    auth.useDeviceLanguage();\n\n    const result = await signInWithPopup(auth, provider);\n    console.log('Google sign in successful:', result);\n    return {\n      name: result.user.displayName,\n      email: result.user.email,\n      uid: result.user.uid\n    };\n  } catch (error) {\n    console.error('Google sign in error:', error);\n    throw new Error(`Sign in failed: ${error.message}`);\n  }\n};\n\n// Add handler for redirect result\nexport const handleRedirectResult = async () => {\n  try {\n    const result = await getRedirectResult(auth);\n    if (result) {\n      return {\n        name: result.user.displayName,\n        email: result.user.email,\n        uid: result.user.uid\n      };\n    }\n    return null;\n  } catch (error) {\n    console.error('Redirect result error:', error);\n    return null;\n  }\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}